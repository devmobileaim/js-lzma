var LZMA=LZMA||{};
(function(a){a.OutWindow=function(){this._windowSize=0};a.OutWindow.prototype.create=function(b){this._buffer&&this._windowSize===b||(this._buffer=new Uint8Array(b));this._windowSize=b;this._streamPos=this._pos=0};a.OutWindow.prototype.flush=function(){var b=this._pos-this._streamPos;if(0!==b){if(this._stream.writeBytes)this._stream.writeBytes(this._buffer,b);else for(var c=0;c<b;c++)this._stream.writeByte(this._buffer[c]);this._pos>=this._windowSize&&(this._pos=0);this._streamPos=this._pos}};a.OutWindow.prototype.releaseStream=
function(){this.flush();this._stream=null};a.OutWindow.prototype.setStream=function(b){this.releaseStream();this._stream=b};a.OutWindow.prototype.init=function(b){b||(this._pos=this._streamPos=0)};a.OutWindow.prototype.copyBlock=function(b,c){var a=this._pos-b-1;for(0>a&&(a+=this._windowSize);c--;)a>=this._windowSize&&(a=0),this._buffer[this._pos++]=this._buffer[a++],this._pos>=this._windowSize&&this.flush()};a.OutWindow.prototype.putByte=function(b){this._buffer[this._pos++]=b;this._pos>=this._windowSize&&
this.flush()};a.OutWindow.prototype.getByte=function(b){b=this._pos-b-1;0>b&&(b+=this._windowSize);return this._buffer[b]};a.RangeDecoder=function(){};a.RangeDecoder.prototype.setStream=function(b){this._stream=b};a.RangeDecoder.prototype.releaseStream=function(){this._stream=null};a.RangeDecoder.prototype.init=function(){var b=5;this._code=0;for(this._range=-1;b--;)this._code=this._code<<8|this._stream.readByte()};a.RangeDecoder.prototype.decodeDirectBits=function(b){for(var c=0,a;b--;)this._range>>>=
1,a=this._code-this._range>>>31,this._code-=this._range&a-1,c=c<<1|1-a,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return c};a.RangeDecoder.prototype.decodeBit=function(b,c){var a=b[c],d=(this._range>>>11)*a;if((this._code^2147483648)<(d^2147483648))return this._range=d,b[c]+=2048-a>>>5,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0;this._range-=d;this._code-=d;b[c]-=a>>>5;0===(this._range&4278190080)&&
(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return 1};a.initBitModels=function(b,a){for(;a--;)b[a]=1024};a.BitTreeDecoder=function(b){this._models=[];this._numBitLevels=b};a.BitTreeDecoder.prototype.init=function(){a.initBitModels(this._models,1<<this._numBitLevels)};a.BitTreeDecoder.prototype.decode=function(b){for(var a=1,e=this._numBitLevels;e--;)a=a<<1|b.decodeBit(this._models,a);return a-(1<<this._numBitLevels)};a.BitTreeDecoder.prototype.reverseDecode=function(b){for(var a=
1,e=0,d=0,f;d<this._numBitLevels;++d)f=b.decodeBit(this._models,a),a=a<<1|f,e|=f<<d;return e};a.reverseDecode2=function(b,a,e,d){for(var f=1,h=0,k=0,l;k<d;++k)l=e.decodeBit(b,a+f),f=f<<1|l,h|=l<<k;return h};a.LenDecoder=function(){this._choice=[];this._lowCoder=[];this._midCoder=[];this._highCoder=new a.BitTreeDecoder(8);this._numPosStates=0};a.LenDecoder.prototype.create=function(b){for(;this._numPosStates<b;++this._numPosStates)this._lowCoder[this._numPosStates]=new a.BitTreeDecoder(3),this._midCoder[this._numPosStates]=
new a.BitTreeDecoder(3)};a.LenDecoder.prototype.init=function(){var b=this._numPosStates;for(a.initBitModels(this._choice,2);b--;)this._lowCoder[b].init(),this._midCoder[b].init();this._highCoder.init()};a.LenDecoder.prototype.decode=function(b,a){return 0===b.decodeBit(this._choice,0)?this._lowCoder[a].decode(b):0===b.decodeBit(this._choice,1)?8+this._midCoder[a].decode(b):16+this._highCoder.decode(b)};a.Decoder2=function(){this._decoders=[]};a.Decoder2.prototype.init=function(){a.initBitModels(this._decoders,
768)};a.Decoder2.prototype.decodeNormal=function(b){var a=1;do a=a<<1|b.decodeBit(this._decoders,a);while(256>a);return a&255};a.Decoder2.prototype.decodeWithMatchByte=function(b,a){var e=1,d,f;do if(d=a>>7&1,a<<=1,f=b.decodeBit(this._decoders,(1+d<<8)+e),e=e<<1|f,d!==f){for(;256>e;)e=e<<1|b.decodeBit(this._decoders,e);break}while(256>e);return e&255};a.LiteralDecoder=function(){};a.LiteralDecoder.prototype.create=function(b,c){var e;if(!this._coders||this._numPrevBits!==c||this._numPosBits!==b)for(this._numPosBits=
b,this._posMask=(1<<b)-1,this._numPrevBits=c,this._coders=[],e=1<<this._numPrevBits+this._numPosBits;e--;)this._coders[e]=new a.Decoder2};a.LiteralDecoder.prototype.init=function(){for(var b=1<<this._numPrevBits+this._numPosBits;b--;)this._coders[b].init()};a.LiteralDecoder.prototype.getDecoder=function(b,a){return this._coders[((b&this._posMask)<<this._numPrevBits)+((a&255)>>>8-this._numPrevBits)]};a.Decoder=function(){this._outWindow=new a.OutWindow;this._rangeDecoder=new a.RangeDecoder;this._isMatchDecoders=
[];this._isRepDecoders=[];this._isRepG0Decoders=[];this._isRepG1Decoders=[];this._isRepG2Decoders=[];this._isRep0LongDecoders=[];this._posSlotDecoder=[];this._posDecoders=[];this._posAlignDecoder=new a.BitTreeDecoder(4);this._lenDecoder=new a.LenDecoder;this._repLenDecoder=new a.LenDecoder;this._literalDecoder=new a.LiteralDecoder;this._dictionarySizeCheck=this._dictionarySize=-1;this._posSlotDecoder[0]=new a.BitTreeDecoder(6);this._posSlotDecoder[1]=new a.BitTreeDecoder(6);this._posSlotDecoder[2]=
new a.BitTreeDecoder(6);this._posSlotDecoder[3]=new a.BitTreeDecoder(6)};a.Decoder.prototype.setDictionarySize=function(b){if(0>b)return!1;this._dictionarySize!==b&&(this._dictionarySize=b,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096)));return!0};a.Decoder.prototype.setLcLpPb=function(b,a,e){var d=1<<e;if(8<b||4<a||4<e)return!1;this._literalDecoder.create(a,b);this._lenDecoder.create(d);this._repLenDecoder.create(d);this._posStateMask=
d-1;return!0};a.Decoder.prototype.setProperties=function(b){if(!this.setLcLpPb(b.lc,b.lp,b.pb))throw Error("Incorrect stream properties");if(!this.setDictionarySize(b.dictionarySize))throw Error("Invalid dictionary size");};a.Decoder.prototype.decodeHeader=function(b){var a,e,d,f,h;if(13>b.size)return!1;a=b.readByte();e=a%9;a=~~(a/9);d=a%5;a=~~(a/5);h=b.readByte();h|=b.readByte()<<8;h|=b.readByte()<<16;h+=16777216*b.readByte();f=b.readByte();f|=b.readByte()<<8;f|=b.readByte()<<16;f+=16777216*b.readByte();
b.readByte();b.readByte();b.readByte();b.readByte();return{lc:e,lp:d,pb:a,dictionarySize:h,uncompressedSize:f}};a.Decoder.prototype.init=function(){var b=4;this._outWindow.init(!1);a.initBitModels(this._isMatchDecoders,192);a.initBitModels(this._isRep0LongDecoders,192);a.initBitModels(this._isRepDecoders,12);a.initBitModels(this._isRepG0Decoders,12);a.initBitModels(this._isRepG1Decoders,12);a.initBitModels(this._isRepG2Decoders,12);a.initBitModels(this._posDecoders,114);for(this._literalDecoder.init();b--;)this._posSlotDecoder[b].init();
this._lenDecoder.init();this._repLenDecoder.init();this._posAlignDecoder.init();this._rangeDecoder.init()};a.Decoder.prototype.decodeBody=function(b,c,e){var d=0,f=0,h=0,k=0,l=0,m=0,g=0;this._rangeDecoder.setStream(b);this._outWindow.setStream(c);for(this.init();0>e||m<e;)if(b=m&this._posStateMask,0===this._rangeDecoder.decodeBit(this._isMatchDecoders,(d<<4)+b))g=this._literalDecoder.getDecoder(m++,g),g=7<=d?g.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(f)):g.decodeNormal(this._rangeDecoder),
this._outWindow.putByte(g),d=4>d?0:d-(10>d?3:6);else{if(1===this._rangeDecoder.decodeBit(this._isRepDecoders,d))g=0,0===this._rangeDecoder.decodeBit(this._isRepG0Decoders,d)?0===this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(d<<4)+b)&&(d=7>d?9:11,g=1):(0===this._rangeDecoder.decodeBit(this._isRepG1Decoders,d)?c=h:(0===this._rangeDecoder.decodeBit(this._isRepG2Decoders,d)?c=k:(c=l,l=k),k=h),h=f,f=c),0===g&&(g=2+this._repLenDecoder.decode(this._rangeDecoder,b),d=7>d?8:11);else if(l=k,k=h,h=
f,g=2+this._lenDecoder.decode(this._rangeDecoder,b),d=7>d?7:10,b=this._posSlotDecoder[5>=g?g-2:3].decode(this._rangeDecoder),4<=b)if(c=(b>>1)-1,f=(2|b&1)<<c,14>b)f+=a.reverseDecode2(this._posDecoders,f-b-1,this._rangeDecoder,c);else{if(f+=this._rangeDecoder.decodeDirectBits(c-4)<<4,f+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),0>f){if(-1===f)break;return!1}}else f=b;if(f>=m||f>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(f,g);m+=g;g=this._outWindow.getByte(0)}this._outWindow.flush();
this._outWindow.releaseStream();this._rangeDecoder.releaseStream();return!0};a.Decoder.prototype.setDecoderProperties=function(a){var c,e;if(5>a.size)return!1;c=a.readByte();e=c%9;c=~~(c/9);if(!this.setLcLpPb(e,c%5,~~(c/5)))return!1;c=a.readByte();c|=a.readByte()<<8;c|=a.readByte()<<16;c+=16777216*a.readByte();return this.setDictionarySize(c)};a.decompress=function(b,c,e,d){var f=new a.Decoder;if(!f.setDecoderProperties(b))throw Error("Incorrect lzma stream properties");if(!f.decodeBody(c,e,d))throw Error("Error in lzma data stream");
return e};a.decompressFile=function(b,c){b instanceof ArrayBuffer&&(b=new a.iStream(b));!c&&a.oStream&&(c=new a.oStream);var e=new a.Decoder,d=e.decodeHeader(b),f=d.uncompressedSize;e.setProperties(d);if(!e.decodeBody(b,c,f))throw Error("Error in lzma data stream");return c};a.decode=a.decompressFile})(LZMA);
